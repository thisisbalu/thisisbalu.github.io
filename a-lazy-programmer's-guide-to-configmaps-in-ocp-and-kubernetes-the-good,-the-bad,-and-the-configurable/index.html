<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>A Lazy Programmer's Guide to ConfigMaps in OCP and Kubernetes: The Good, The Bad, and The Configurable | Bala Subramanyam Lanka</title> <meta name="author" content="Bala Subramanyam Lanka"> <meta name="description" content="Dive into the world of ConfigMaps in OpenShift and Kubernetes with this laid-back guide that weighs the pros and cons and explores various setups with easy-to-digest code snippets."> <meta name="keywords" content="balasubramanyamlanka, lbs, technology, resume, balu, balu-website, balasubramanyamlanka-resume, blog, java, scaling"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/main/favicon.png?d375935be3581fdc7922f5745994398a"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://balasubramanyamlanka.com/a-lazy-programmer's-guide-to-configmaps-in-ocp-and-kubernetes-the-good,-the-bad,-and-the-configurable/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Bala Subramanyam </span>Lanka</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">A Lazy Programmer's Guide to ConfigMaps in OCP and Kubernetes: The Good, The Bad, and The Configurable</h1> <p class="post-meta">December 2, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/configmaps"> <i class="fas fa-hashtag fa-sm"></i> ConfigMaps</a>   <a href="/blog/tag/ocp"> <i class="fas fa-hashtag fa-sm"></i> OCP</a>     ·   <a href="/blog/category/kubernetes"> <i class="fas fa-tag fa-sm"></i> Kubernetes</a>   <a href="/blog/category/devops"> <i class="fas fa-tag fa-sm"></i> DevOps</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Alright, fellow code wranglers! Today, I’m diving into one of those magical things that makes configuring your applications in Kubernetes and OpenShift so much easier—ConfigMaps. Sounds fancy, right? But what are they, and why should you give a damn? Let’s break it down, with a sprinkle of humor and some code to keep things spicy.</p> <h3 id="what-the-heck-is-a-configmap">What the Heck is a ConfigMap?</h3> <p>In plain English, a ConfigMap is a Kubernetes object that lets you separate your configuration data from your application code. This means you can change the configuration without having to recompile or redeploy your app, which is pretty sweet. Whether you’re working in Kubernetes or OpenShift (which is basically Kubernetes on steroids), ConfigMaps are your go-to for managing non-sensitive configuration data.</p> <h3 id="why-should-you-even-use-configmaps">Why Should You Even Use ConfigMaps?</h3> <p><strong>Pros</strong>:</p> <ol> <li> <strong>Decoupling Config from App Code</strong>: This is like the biggest plus. Your app becomes more flexible and easier to manage.</li> <li> <strong>Easy Updates</strong>: Change configs on-the-fly without redeploying your app. It’s like changing clothes without taking a shower.</li> <li> <strong>Reusability</strong>: You can use the same ConfigMap across multiple deployments. It’s like having that one cool shirt you can wear to any party.</li> <li> <strong>Version Control</strong>: You can use ConfigMaps in conjunction with GitOps practices for better version control.</li> </ol> <p><strong>Cons</strong>:</p> <ol> <li> <strong>Complexity</strong>: Sure, they love to tout decoupling, but adding another layer of abstraction can get messy.</li> <li> <strong>Memory Overhead</strong>: If you are storing large amounts of data, this can add some bloat and cost—so don’t overdo it like that extra cheese on your pizza.</li> <li> <strong>Limitations for Sensitive Data</strong>: ConfigMaps aren’t meant for sensitive info like passwords or secrets. That’s what Secrets are for.</li> </ol> <h3 id="possible-setups-for-configmaps">Possible Setups for ConfigMaps</h3> <h4 id="1-basic-configmap-creation">1. Basic ConfigMap Creation</h4> <p>Creating a ConfigMap is as simple as saying “abracadabra.” You can create it from a literal value, a file, or even from environment variables.</p> <p><strong>Creating from a Literal Value:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create configmap my-config <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">key1</span><span class="o">=</span>value1 <span class="nt">--from-literal</span><span class="o">=</span><span class="nv">key2</span><span class="o">=</span>value2
</code></pre></div></div> <p><strong>Creating from a File:</strong></p> <p>Imagine you have a <code class="language-plaintext highlighter-rouge">config.txt</code> file with your key-value pairs.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create configmap my-config <span class="nt">--from-file</span><span class="o">=</span>config.txt
</code></pre></div></div> <p><strong>Creating from Environment Variables:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create configmap my-env-config <span class="nt">--from-env-file</span><span class="o">=</span>env.list
</code></pre></div></div> <h4 id="2-using-configmap-in-pods">2. Using ConfigMap in Pods</h4> <p>Perfect, you’ve created a ConfigMap—now how do you use it? There are a few ways to do this in your Pods: using environment variables or mounting the ConfigMap as a volume.</p> <p><strong>Using as Environment Variables:</strong></p> <p>Here’s a simple deployment YAML that pulls in the ConfigMap values:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">my-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">2</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">my-app</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">my-app</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">my-container</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">my-image:latest</span>
        <span class="na">env</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">KEY1</span>
          <span class="na">valueFrom</span><span class="pi">:</span>
            <span class="na">configMapKeyRef</span><span class="pi">:</span>
              <span class="na">name</span><span class="pi">:</span> <span class="s">my-config</span>
              <span class="na">key</span><span class="pi">:</span> <span class="s">key1</span>
</code></pre></div></div> <p><strong>Mounting as a Volume:</strong></p> <p>If you want to mount the ConfigMap into your file system, you can do it like this:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">my-app</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">2</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">my-app</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">my-app</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">my-container</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">my-image:latest</span>
        <span class="na">volumeMounts</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
          <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/etc/config</span>
      <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
        <span class="na">configMap</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">my-config</span>
</code></pre></div></div> <h3 id="3-updating-a-configmap">3. Updating a ConfigMap</h3> <p>Updating is where it gets fun. You can edit a ConfigMap with a simple command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl edit configmap my-config
</code></pre></div></div> <p>Run that bad boy, make your changes, and boom—your deployment will automatically pick up the new config (as long as you’re on a rolling update!).</p> <p>However, keep in mind that if you change the ConfigMap, you’ll still need to restart your Pods to see changes reflected. No magic here, folks.</p> <h3 id="conclusion">Conclusion</h3> <p>So that’s the lowdown on ConfigMaps in Kubernetes and OpenShift. They can simplify your life, making your application more flexible, but they can also complicate things if you’re not careful. There’s a balance, as with all things in life—or at least your code deployment pipeline.</p> <p>Just remember, though, ConfigMaps are great for configuration management, but don’t get lazy and try to put everything in them—keep some data in Secrets for that sensitive stuff, and don’t forget to manage your ConfigMaps like the precious gems they are!</p> <h3 id="references">References</h3> <ul> <li><a href="https://kubernetes.io/docs/concepts/configuration/configmap/" rel="external nofollow noopener" target="_blank">Kubernetes Official ConfigMap Documentation</a></li> <li><a href="https://docs.openshift.com/container-platform/latest/nodes/pods-nodes.html#configmap-overview" rel="external nofollow noopener" target="_blank">OpenShift ConfigMap Documentation</a></li> <li><a href="https://kubernetes.io/docs/concepts/configuration/overview/#manifests-and-yaml" rel="external nofollow noopener" target="_blank">Kubernetes YAML Basics</a></li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/leetcode-question-1342-number-of-steps-to-reduce-a-number-to-zero-my-simple-solution/">LeetCode Question 1342: Number of Steps to Reduce a Number to Zero - My Simple Solution</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/leetcode-question-412-fizz-buzz-my-simple-solution/">Leetcode Question 412: Fizz Buzz - My Simple Solution</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/leetcode-problem-1672-solving-the-richest-customer-wealth-challenge/">LeetCode Problem 1672: Solving the Richest Customer Wealth Challenge</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/getting-the-running-sum-on-leetcode-simple-solutions-for-everyday-problems/">LeetCode Problem 1480: Sum</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/mastering-kubernetes-limits-and-requests-a-programmer's-guide-to-staying-in-control/">Mastering Kubernetes Limits and Requests: A Programmer's Guide to Staying in Control</a> </li> </div> </div> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Bala Subramanyam Lanka. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>